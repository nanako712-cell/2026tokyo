<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TOKYO & FUJI TRIP 2026</title>
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1A1A1A">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500&family=Shippori+Mincho:wght@400;500;600&display=swap" rel="stylesheet">
<style>
    /* 基礎樣式 */
    :root {
        --bg: #F9F9F9;
        --card-bg: #FFFFFF;
        --text-main: #1A1A1A;
        --text-sub: #8C8C8C;
        --accent: #A6A6A6;
        --line: #EFEFEF;
        --shadow: 0 4px 20px rgba(0,0,0,0.03);
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { font-family: 'Shippori Mincho', 'Noto Sans JP', serif; background-color: var(--bg); color: var(--text-main); margin: 0; padding-bottom: 80px; -webkit-font-smoothing: antialiased; letter-spacing: 0.05em; }
    .icon { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 1.5; vertical-align: middle; }
    .icon-sm { width: 14px; height: 14px; }
    .icon-lg { width: 22px; height: 22px; } /* 加大底部導航圖示 */
    
    /* Header */
    header { background: var(--bg); padding-top: 20px; text-align: center; position: sticky; top: 0; z-index: 100; }
    header.scrolled .date-scroller { border-bottom: 1px solid var(--line); box-shadow: var(--shadow); }
    .trip-tag { font-family: 'Noto Sans JP', sans-serif; font-size: 10px; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 5px; display: block; }
    h1 { font-size: 20px; font-weight: 500; margin: 0 0 15px 0; }
    
    /* Date Scroller */
    .date-scroller { display: flex; overflow-x: auto; padding: 10px 20px; gap: 20px; scrollbar-width: none; background: var(--bg); border-bottom: 1px solid transparent; transition: border 0.3s; }
    .date-scroller::-webkit-scrollbar { display: none; }
    .date-item { display: flex; flex-direction: column; align-items: center; min-width: 45px; opacity: 0.4; transition: 0.3s; cursor: pointer; }
    .date-item.active { opacity: 1; transform: scale(1.05); }
    .date-item .dow { font-size: 9px; font-family: 'Noto Sans JP'; font-weight: 500; margin-bottom: 4px; }
    .date-item .day { font-size: 18px; font-family: 'Shippori Mincho'; font-weight: 600; }
    .date-item.active .day { border-bottom: 2px solid #a33e3e; padding-bottom: 2px; }
    
    /* Hero & Weather */
    .hero { position: relative; margin: 10px 20px 20px 20px; border-radius: 4px; overflow: hidden; height: 200px; box-shadow: var(--shadow); }
    .hero img { width: 100%; height: 100%; object-fit: cover; }
    .hero-text { position: absolute; bottom: 0; left: 0; width: 100%; padding: 20px; background: linear-gradient(to top, rgba(0,0,0,0.6), transparent); color: white; }
    .hero-title { font-size: 22px; font-weight: 500; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
    .hero-subtitle { font-size: 11px; font-family: 'Noto Sans JP'; opacity: 0.9; margin-top: 5px; display: flex; align-items: center; gap: 5px;}
    .weather-row { display: flex; justify-content: space-between; padding: 0 25px 20px 25px; margin-bottom: 10px; border-bottom: 1px solid var(--line); }
    .weather-col { display: flex; flex-direction: column; align-items: center; gap: 5px; }
    .weather-time { font-size: 10px; color: var(--text-sub); font-family: 'Noto Sans JP'; }
    .weather-temp { font-size: 14px; font-weight: 500; }
    
    /* Cards */
    .container { padding: 0 20px; }
    .timeline-item { position: relative; padding-left: 20px; margin-bottom: 30px; animation: fadeIn 0.4s ease; }
    .time-badge { font-family: 'Shippori Mincho'; font-size: 24px; font-weight: 400; margin-bottom: 8px; display: flex; align-items: baseline; gap: 8px; }
    .time-badge span { font-size: 12px; color: var(--text-sub); font-family: 'Noto Sans JP'; border: 1px solid var(--text-sub); padding: 1px 6px; border-radius: 2px; }
    .card { background: var(--card-bg); border-radius: 2px; padding: 20px; box-shadow: var(--shadow); border: 1px solid #F5F5F5; }
    .card-title { font-size: 18px; font-weight: 600; margin-bottom: 5px; letter-spacing: 0.08em; }
    .card-loc { font-size: 11px; color: var(--text-sub); margin-bottom: 15px; font-family: 'Noto Sans JP'; display: flex; align-items: center; gap: 4px; }
    .info-block { background: #F8F8F8; padding: 12px 15px; margin-bottom: 10px; border-radius: 2px; display: flex; justify-content: space-between; align-items: center; }
    .info-label { font-size: 9px; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 2px; }
    .info-value { font-size: 14px; font-weight: 500; font-family: 'Noto Sans JP'; }
    .desc { font-size: 13px; line-height: 1.8; color: #555; font-family: 'Noto Sans JP'; margin-top: 15px; padding-top: 15px; border-top: 1px dashed var(--line); }
    .tag { font-size: 10px; display: inline-block; width: fit-content; padding: 2px 8px; border-radius: 4px; margin-bottom: 5px; color: white; font-family: 'Noto Sans JP'; font-weight: 500;}
    .tag-food { background: #E91E63; } /* Pink/Red for food */
    .tag-spot { background: #2196F3; } /* Blue for spot */
    .tag-trans { background: #FF9800; } /* Orange for transport */
    .tag-stay { background: #4CAF50; } /* Green for stay */
    .tag-shop { background: #A0522D; } /* Brown for shop */
    .btn-nav { display: flex; align-items: center; justify-content: center; width: 100%; background: #1A1A1A; color: white; padding: 12px 0; border-radius: 2px; text-decoration: none; font-size: 12px; font-family: 'Noto Sans JP'; margin-top: 15px; gap: 8px; }
    .add-btn-float { position: fixed; bottom: 100px; right: 20px; background: #a33e3e; color: white; border: none; width: 50px; height: 50px; border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 150; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }
    .add-btn-float:hover { transform: scale(1.1); }
    .add-btn-float svg { width: 24px; height: 24px; stroke: white; fill: none; stroke-width: 2;}

    /* Budget & Category Styles */
    .budget-header { text-align: center; padding: 40px 20px; background: white; margin-bottom: 20px; box-shadow: var(--shadow); }
    .budget-total-label { font-size: 12px; color: var(--text-sub); margin-bottom: 5px; }
    .budget-total-amount { font-size: 36px; font-weight: 500; }
    .budget-input-group { background: white; padding: 0 20px 20px 20px; margin: 0 20px; box-shadow: var(--shadow); border-radius: 2px; }
    .b-input { width: 100%; border: none; border-bottom: 1px solid #ddd; padding: 10px 0; font-family: 'Noto Sans JP'; font-size: 14px; margin-bottom: 15px; border-radius: 0; }
    .b-btn { width: 100%; background: #1A1A1A; color: white; border: none; padding: 12px; font-size: 12px; cursor: pointer; }
    
    /* Category Selector (Budget) */
    .category-selector { display: flex; justify-content: space-between; padding: 10px 20px; margin-bottom: 15px; border-top: 1px solid #eee; border-bottom: 1px solid #eee; background: #fff; }
    .category-selector input[type="radio"] { display: none; }
    .category-selector label { flex-grow: 1; text-align: center; padding: 8px 0; cursor: pointer; font-size: 10px; color: #888; background: #fff; border-radius: 4px; margin: 0 2px; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; user-select: none; }
    .category-selector input[type="radio"]:checked + label { background: #eaf1ed; color: #1A1A1A; font-weight: 600; }
    .category-selector label svg { margin-bottom: 3px; width: 20px; height: 20px; stroke: #888; fill: none; stroke-width: 1.5; }
    .category-selector input[type="radio"]:checked + label svg { stroke: #388E3C; }

    /* Expense List */
    .expense-list { list-style: none; padding: 0; margin: 20px 0; background: #fff; }
    .expense-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 20px; border-bottom: 1px solid #eee; background: #fff; }
    .expense-item-left { display: flex; align-items: center; gap: 12px; }
    .expense-icon-circle { width: 32px; height: 32px; border-radius: 50%; background: #f5f5f5; display: flex; align-items: center; justify-content: center; }
    .expense-icon-circle svg { width: 16px; height: 16px; stroke: #555; fill: none; stroke-width: 1.5; }
    .expense-info { display: flex; flex-direction: column; }
    .expense-name { font-size: 14px; font-weight: 500; color: #333; }
    .expense-cat-name { font-size: 10px; color: #999; }
    .expense-amount { font-size: 16px; font-weight: 600; color: #1A1A1A; }
    .delete-btn { color: #ccc; margin-left: 10px; cursor: pointer; font-size: 18px; line-height: 1; }

    /* Checklist Styles (NEW) */
    .checklist-item {
        display: flex;
        align-items: center;
        padding: 15px 10px;
        background: var(--card-bg);
        margin-bottom: 1px;
        border-bottom: 1px solid var(--line);
        cursor: pointer;
        transition: background 0.2s;
        font-family: 'Noto Sans JP', sans-serif;
    }
    .checklist-item:first-child { border-radius: 4px 4px 0 0; }
    .checklist-item:last-child { border-bottom: none; border-radius: 0 0 4px 4px; }
    .checklist-item-container { box-shadow: var(--shadow); border-radius: 4px; margin-bottom: 20px; border: 1px solid #F5F5F5; }
    .checklist-item input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        width: 22px;
        height: 22px;
        border: 2px solid #A6A6A6;
        border-radius: 50%;
        margin-right: 15px;
        position: relative;
        cursor: pointer;
        transition: all 0.2s;
        flex-shrink: 0;
    }
    .checklist-item input[type="checkbox"]:checked {
        background-color: #388E3C;
        border-color: #388E3C;
    }
    .checklist-item input[type="checkbox"]:checked:after {
        content: '✓';
        color: white;
        font-size: 14px;
        font-weight: bold;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        line-height: 1;
    }
    .checklist-item span {
        flex-grow: 1;
        font-size: 14px;
        color: var(--text-main);
    }
    .checklist-item.checked span {
        text-decoration: line-through;
        color: var(--text-sub);
    }

    /* Modal for Itinerary Editing */
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 250; display: none; justify-content: center; align-items: flex-end; }
    .modal-content { background: white; width: 100%; max-width: 600px; border-radius: 10px 10px 0 0; padding: 20px; animation: slideUp 0.3s ease-out; }
    .modal-content h2 { font-size: 20px; margin-top: 0; margin-bottom: 15px; font-weight: 600; }
    .modal-input { width: 100%; border: 1px solid #ddd; padding: 10px; margin-bottom: 15px; border-radius: 4px; font-family: 'Noto Sans JP'; }
    .modal-input-group { display: flex; gap: 10px; margin-bottom: 15px; }
    .modal-input-group input { flex: 1; }
    .modal-select { padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: 'Noto Sans JP'; }
    .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
    .modal-btn-cancel { background: #DDD; color: #555; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
    .modal-btn-save { background: #388E3C; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }

    /* Tags for Editing Modal */
    .edit-tags-group { display: flex; gap: 10px; margin-bottom: 15px; }
    .edit-tags-group input[type="radio"] { display: none; }
    .edit-tags-group label { flex: 1; text-align: center; padding: 8px 5px; border-radius: 4px; font-size: 12px; cursor: pointer; opacity: 0.7; transition: opacity 0.2s; }
    .edit-tags-group input[type="radio"]:checked + label { opacity: 1; border: 2px solid; }
    .tag-edit-food { background: #F8BBD0; color: #E91E63; }
    .tag-edit-food input[type="radio"]:checked + label { border-color: #E91E63; }
    .tag-edit-spot { background: #BBDEFB; color: #2196F3; }
    .tag-edit-spot input[type="radio"]:checked + label { border-color: #2196F3; }
    .tag-edit-trans { background: #FFE0B2; color: #FF9800; }
    .tag-edit-trans input[type="radio"]:checked + label { border-color: #FF9800; }
    .tag-edit-stay { background: #C8E6C9; color: #4CAF50; }
    .tag-edit-stay input[type="radio"]:checked + label { border-color: #4CAF50; }
    .tag-edit-shop { background: #FFCCBC; color: #A0522D; } /* Light Brown for shop */

    @keyframes slideUp {
        from { transform: translateY(100%); }
        to {